## Esercitazione 7
#--------------------------------------------------------
#Es. 1 
n = 30
mu = 1    # 1 minuto
si = 1/12 # 5 sec

nT = n*mu
s2T= n*(si)^2

1 - pnorm((31-nT)/sqrt(s2T))

#--------------------------------------------------------
#Es. 2
X = matrix( runif(100*1000,0,1), nrow = 100, ncol = 1000)
Y = X^2;

mu = colMeans(Y); 
hist(mu)

mean(mu) # 1/3
var(mu) # 4/(45*100) ->> OSS: errore fare 4/(45*1000)

#--------------------------------------------------------
#Es. 3
n = 25
lambda = 1/12
mu = n*1/lambda
va = n*(1/lambda)^2

1 - pnorm((365 - mu)/sqrt(va))

#--------------------------------------------------------
# Es. 4
g = 0.95
q1 = qnorm((1-g)/2)
q2 = -q1

xm = mean(c(12.21, 12.33, 12.84, 12.97, 13.22, 
            12.93, 13.07, 13.52, 13.23, 13.01))

#i)
IC = xm + c(+1, -1)*q1*0.1/sqrt(10) 
l = IC[2] - IC[1]

#ii)
nnew = ceiling((2*q2*0.1/0.1)^2)
# check 
IC = xm + c(+1, -1)*q1*0.1/sqrt(nnew) 
l = IC[2] - IC[1]

#--------------------------------------------------------
# Es. 5
l = (9.875 - 8.404)
xn = 8.404 + l/2

q1 = qnorm((1 - 0.90)/2)
n = ceiling(((2*q1*sqrt(3))/l)^2)

#--------------------------------------------------------
# Es 6
n = 4
q1 = qt((1-0.95)/2,n-1)

xm = mean(c(88.7, 89.0, 88.5, 88.8))
s = sqrt(var(c(88.7, 89.0, 88.5, 88.8)))
ICu = xm + c(+1, -1)*q1*s/sqrt(n)

#--------------------------------------------------------
#Es. 7
x = c(16.2, 14.4, 17.1, 18, 16.2, 15.6, 15.5)
xm = mean(x);
s = sqrt(var((x)));

n = length(x)
ICu = xm + c(+1,-1)*qt((1-0.95)/2,n-1)*s/sqrt(n)

ICs= s*sqrt((n-1)/qchisq(1-0.9,n-1))

#--------------------------------------------------------
#Es. 8
x = c(6,8,13,5,7,9,8,11)
n = length(x)
xm = mean(x)
s = sqrt(var(x)) # /(n-1)
g = 0.95

q1 = qt((1 - g)/2,n-1)
ICu = xm + c(+1,-1)*q1*s/sqrt(n)

q1 = qchisq((1-g)/2,n-1)
q2 = qchisq((1+g)/2,n-1)

ICs2 = c((n-1)*s^2/q2,(n-1)*s^2/q1) 
ICs = sqrt(ICs2)

#--------------------------------------------------------
#Es. 9
x = c(501, 498, 501, 500, 502, 499)
n = length(x)
mu = 500
g = 0.95

q1 = qchisq((1-g)/2,n)
q2 = qchisq((1+g)/2,n)

# lo stimatore è /n e la media è nota
s2 = sum((x-mu)^2)/n
ICs = sqrt(c(s2*n/q2, s2*n/q1))

#--------------------------------------------------------
#Es. 10

A = 0.04
n = 10
g = 0.9

q1 = qchisq((1-g)/2,n)
q2 = qchisq((1+g)/2,n)

s2 = A/n
ICs = sqrt(c(s2*n/q2,s2*n/q1))
